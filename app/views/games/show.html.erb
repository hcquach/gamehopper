<%= content_for(:title) do %>
Game Hopper-<%= @game.title %>
<% end %>

<div class="single-game-container">

  <div class="wrapper">

      <div class="game-photo" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('<%= cl_image_path @game.photo, crop: :fill_pad %>');">

      <div class="
        <% case @game.platform %>
        <% when "XBOX" %>
        <%= "nav-xbox" %>
        <% when "PS4" %>
        <%= "nav-ps4" %>
        <% when "SWITCH" %>
        <%= "nav-switch" %>
        <% end %>
        ">
      </div>

      </div>

      <div class="game-info">

        <div class="title">
          <h1><%= @game.title %></h1>
          <h2><%= @game.description %></h2>
        </div>

        <div class="availability">
          <h2>
            <%= @game.available ? "Available" : "Not Available" %>
          </h2>
        </div>

        <div class="button-container">

          <div class="button">
            <% if @game.user == current_user %>
              <%= link_to 'Delete', game_path(@game), method: :delete, class: "btn btn-danger btn-delete" %>
            <% end %>
          </div>

          <div class="button">
            <% unless @game.user == current_user %>
              <%#= link_to "Rent", game_rentals_path(@game), method: :create, class: "btn btn-primary btn-rent", data: { toggle: "modal", target:'#exampleModal' } %>
              <button type="button" class="btn btn-primary btn-green-flat-trigger" data-toggle="modal" data-target="#exampleModal">
                Rent
              </button>

            <% end %>
          </div>

        </div>

      </div>

    </div>

  <div
      id="map"
      data-markers="<%= @markers.to_json %>"
    ></div>

</div>

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"><br>
          <strong>Game: </strong><%= @game.user.username %>'s <strong><%= @game.title %><br>
          Meeting point: </strong><%= @game.user.address %><br><br>
          <strong>Arrange an appointment for the handover</strong>
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="message-text" class="col-form-label"><h5>Message:</h5></label>
            <textarea class="form-control" id="message-text"></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"><h5>Close</h5></button>

        <%= mail_to @game.user.email, "My email",
         subject: "You've got a new rental from Game Hopper!" %>

        <a href="mailto:no-one@snai1mai1.com?subject=free chocolate" onclick="window.open('http://yahoo.com');">Confirm</a>
        <%= link_to "Confirm", game_rentals_path(@game), method: :create, class: "btn btn-primary btn-rent" %>
      </div>
    </div>
  </div>
</div>
